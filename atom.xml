<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Supreme</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://6324up.xyz/"/>
  <updated>2018-07-18T10:47:45.214Z</updated>
  <id>http://6324up.xyz/</id>
  
  <author>
    <name>周琳</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>SVN</title>
    <link href="http://6324up.xyz//blog/hello-world.html"/>
    <id>http://6324up.xyz//blog/hello-world.html</id>
    <published>2018-07-18T10:16:00.000Z</published>
    <updated>2018-07-18T10:47:45.214Z</updated>
    
    <content type="html"><![CDATA[<p>一.日常使用手册</p><p>1.创建svn项目<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># svnadmin create /data/svn/newproject        --svn项目：newproject</span></span><br></pre></td></tr></table></figure></p><p>2.创建用户<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># htpasswd /data/svnauth/passwd newuser       --用户：newuser</span></span><br></pre></td></tr></table></figure></p><p>3.配置仓库权限<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vim /data/svnauth/authz</span></span><br><span class="line">[groups]                               --配置组，用户</span><br><span class="line">develop = test1,test2,testzl           --格式：组 = 用户       多个用户用逗号隔开</span><br><span class="line">android = test3</span><br><span class="line">admin = zhouladmin</span><br><span class="line">dgg = dg</span><br><span class="line">                                       --不同项目之间空一行隔开</span><br><span class="line">[newproject:/]                         --配置svn项目权限</span><br><span class="line">@develop = rw</span><br><span class="line">@admin = rw</span><br><span class="line">* =</span><br></pre></td></tr></table></figure></p><p>注意：使用浏览器登陆仓库后会保存缓存，导致无法登陆其他仓库，清理浏览器缓存即可</p><p>二、部署</p><p>1.安装<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># apt-get -y install subversion apache2 libapache2-svn ssl-cert</span></span><br></pre></td></tr></table></figure></p><p>如果apache相关软件无法安装，则换一个安装源再次安装即可</p><p>更换国内源<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mv /etc/apt/sources.list /etc/apt/sources.list.bak</span></span><br><span class="line"><span class="comment"># cat &gt; /etc/apt/sources.list &lt;&lt; EOF    </span></span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ trusty main restricted universe multiverse  </span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ trusty-security main restricted universe multiverse  </span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ trusty-updates main restricted universe multiverse  </span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ trusty-proposed main restricted universe multiverse  </span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ trusty-backports main restricted universe multiverse  </span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ trusty main restricted universe multiverse  </span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ trusty-security main restricted universe multiverse  </span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ trusty-updates main restricted universe multiverse  </span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ trusty-proposed main restricted universe multiverse  </span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ trusty-backports main restricted universe multiverse  </span><br><span class="line">EOF</span><br><span class="line"><span class="comment"># apt-get update</span></span><br></pre></td></tr></table></figure></p><p>查看安装版本<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># svn –version</span></span><br><span class="line">svn, version 1.8.8 (r1568071)</span><br><span class="line">   compiled Aug 10 2017, 17:20:39 on x86_64-pc-linux-gnu</span><br></pre></td></tr></table></figure></p><p>  2.配置</p><p>2.1svn仓库基本配置</p><p>创建svn仓库存储路径<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mkdir -p /data/svn</span></span><br></pre></td></tr></table></figure></p><p>修改/data目录属性</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># chown -R www-data:www-data /data/</span></span><br><span class="line"><span class="comment"># chmod 755 -R /data/</span></span><br></pre></td></tr></table></figure><p>2.2创建svn仓库<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># svnadmin create /data/svn/devroot         --仓库名：devroot</span></span><br></pre></td></tr></table></figure></p><p>2.3svn仓库权限配置</p><p>svn仓库权限，可以进行单独配置，也可以进行统一配置。考虑实际情况，一般会有多个svn仓库，这里采用统一配置。</p><p>创建用于管理所有仓库帐号密码、权限控制等的目录svnauth<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mkdir -p /data/svnauth/</span></span><br></pre></td></tr></table></figure></p><p>创建svn仓库权限的总控制文件svnserve.conf<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vim /data/svnauth/svnserve.conf</span></span><br><span class="line">[general]</span><br><span class="line"><span class="comment">#未鉴定的用户无权限访问该版本库</span></span><br><span class="line">anon-access = none</span><br><span class="line"></span><br><span class="line"><span class="comment">#鉴定后的可读写版本库</span></span><br><span class="line">auth-access = write</span><br><span class="line"></span><br><span class="line"><span class="comment">#使用的密码文件是同级路径的passwd文件，即是/data/svnaut/passwd</span></span><br><span class="line">password-db = passwd</span><br><span class="line"></span><br><span class="line"><span class="comment">#使用的权限控制文件是同级路径的authz文件，即是/data/svndauth/authz</span></span><br><span class="line">authz-db = authz</span><br><span class="line"></span><br><span class="line"><span class="comment">#realm指定版本库的认证域，即在登录时提示的认证域名称。各个仓库的认证域都可以自定义</span></span><br><span class="line">realm = svnauth</span><br></pre></td></tr></table></figure></p><p><img src="/images/1531724442366.jpg" alt="“图片描述”"></p><p>创建passwd文件<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># touch /data/svnauth/passwd</span></span><br></pre></td></tr></table></figure></p><p>创建authz文件<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vim /data/svndata/authz</span></span><br><span class="line">[groups]             //用户组配置</span><br><span class="line">develop = test1,test2,testzl           //定义develop用户组成员test1,test2,testzl</span><br><span class="line">android = test3</span><br><span class="line">admin = zhouladmin</span><br><span class="line">dgg = dg</span><br><span class="line"></span><br><span class="line">[devroot:/]                     //仓库权限配置，仓库名：devroot</span><br><span class="line">@develop = rw                    //develop用户组具有读（r）写(w)权限</span><br><span class="line">@admin = rw</span><br><span class="line">* =                          //其他用户和组没有访问权限</span><br></pre></td></tr></table></figure></p><p><img src="/images/1531725835361.jpg" alt="“图片描述”"></p><p>2.4配置访问方式（此处为https）</p><p>配置apache2<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vim /etc/apache2/mods-available/dav_svn.conf</span></span><br><span class="line">&lt;Location /repos&gt;</span><br><span class="line">   DAV svn</span><br><span class="line">   SVNParentPath /data/svn</span><br><span class="line">   AuthzSVNAccessFile /data/svnauth/authz</span><br><span class="line">   AuthType Basic</span><br><span class="line">   AuthName <span class="string">"Authorization Realm"</span></span><br><span class="line">   AuthUserFile /data/svnauth/passwd</span><br><span class="line">   Require valid-user</span><br><span class="line">   SSLRequireSSL</span><br><span class="line">&lt;/Location&gt;</span><br></pre></td></tr></table></figure></p><p>启用ssl模块<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># a2enmod ssl</span></span><br></pre></td></tr></table></figure></p><p>如果没有a2enmod指令，也可直接在apache2.conf中设置SSL模块加载，如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LoadModule ssl_module /usr/lib/apache2/modules/mod_ssl.so</span><br></pre></td></tr></table></figure></p><p>启用SSL站点<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># a2ensite default-ssl</span></span><br></pre></td></tr></table></figure></p><p>重启apache<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># service apache2 restart</span></span><br></pre></td></tr></table></figure></p><p>2.5设置svn的用户和密码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># htpasswd -cm /data/svnauth/passwd testzl      --创建用户：testzl</span></span><br></pre></td></tr></table></figure><p>配置用户权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vim /data/svnauth/authz           --配置testzl的组和访问svn仓库的权限</span></span><br></pre></td></tr></table></figure><p><img src="/images/1531726817825.jpg" alt="“图片描述”"></p><p>3.访问测试</p><p>浏览器输入：<a href="https://IP/repos/devroot" target="_blank" rel="noopener">https://IP/repos/devroot</a></p><p><img src="/images/1531726675853.jpg" alt="“图片描述”"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;一.日常使用手册&lt;/p&gt;
&lt;p&gt;1.创建svn项目&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>rabbitmq添加虚拟主机</title>
    <link href="http://6324up.xyz//blog/Plan.html"/>
    <id>http://6324up.xyz//blog/Plan.html</id>
    <published>2018-03-08T08:27:00.000Z</published>
    <updated>2018-07-18T10:15:38.606Z</updated>
    
    <content type="html"><![CDATA[<p>创建用户（如果没有的话）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># rabbitmqctl  add_user test 123456                 --用户：test，密码：123456</span></span><br></pre></td></tr></table></figure><p>创建虚拟主机<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># rabbitmqctl add_vhost test_host                   --虚拟主机名：test_host</span></span><br></pre></td></tr></table></figure></p><p>查看虚拟主机列表<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># rabbitmqctl list_vhosts</span></span><br></pre></td></tr></table></figure></p><p>配置用户权限（此处为读写权限）<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># rabbitmqctl set_permissions -p test_host  test ".*" ".*" ".*"         --用户test对test_host虚拟主机具有读写权限</span></span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;创建用户（如果没有的话）&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;c
      
    
    </summary>
    
    
  </entry>
  
</feed>
